print "START"

print "queue 1"
set q [queue]
push $q alfa
push $q beta
push $q gama

range 0 2 | foreach i {
    print [pop $q]
}

print "queue 2"
set q [queue 2]

proc on.error (e) {
    print "Error handled: " <$e message>
    print "Popping from the queue:"
    range 0 2 | foreach i {
        print [pop.no_wait $q]
    }
    return 0
}

push.no_wait $q alfa
push.no_wait $q beta
print "Trying to push into a full queue"
push.no_wait $q gama

print "END"
